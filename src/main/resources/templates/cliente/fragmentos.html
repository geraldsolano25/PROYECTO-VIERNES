<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
    <head th:fragment="head">
        <title>Legado Barbería - Clientes</title>
        <meta charset="UTF-8"/>
        
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        
        <!-- Webjars -->
        <link th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" rel="stylesheet"/>
        <link th:href="@{/webjars/font-awesome/css/all.css}" rel="stylesheet"/>
        
        <!-- Google Fonts (estilo VorkBarbier) -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
        
        <!-- Estilos personalizados VorkBarbier -->
        <style>
            /* Variables de estilo VorkBarbier */
            :root {
                --primary-color: #1a1a1a;
                --secondary-color: #c9a96e;
                --light-bg: #f8f9fa;
                --dark-bg: #121212;
                --text-light: #ffffff;
                --text-dark: #333333;
                --border-color: #e0e0e0;
                --success-color: #28a745;
                --danger-color: #dc3545;
                --warning-color: #ffc107;
                --info-color: #17a2b8;
                --font-heading: 'Playfair Display', serif;
                --font-body: 'Roboto', sans-serif;
                --border-radius: 8px;
                --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
                --transition: all 0.3s ease;
            }
            
            /* Estilos generales */
            body {
                font-family: var(--font-body);
                color: var(--text-dark);
                background-color: #ffffff;
                line-height: 1.6;
            }
            
            h1, h2, h3, h4, h5, h6 {
                font-family: var(--font-heading);
                font-weight: 700;
                color: var(--primary-color);
            }
            
            /* Cards */
            .card {
                border: none;
                box-shadow: var(--box-shadow);
                border-radius: var(--border-radius);
                margin-bottom: 1.5rem;
                transition: var(--transition);
            }
            
            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            }
            
            .card-header {
                background-color: var(--primary-color);
                color: var(--text-light);
                border-bottom: 3px solid var(--secondary-color);
                font-family: var(--font-heading);
                padding: 1rem 1.5rem;
                border-radius: var(--border-radius) var(--border-radius) 0 0 !important;
            }
            
            /* Botones */
            .btn-primary {
                background-color: var(--primary-color);
                border-color: var(--primary-color);
                font-weight: 500;
                padding: 0.5rem 1.5rem;
                border-radius: 4px;
                transition: var(--transition);
            }
            
            .btn-primary:hover {
                background-color: #333;
                border-color: #333;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }
            
            .btn-warning {
                background-color: var(--secondary-color);
                border-color: var(--secondary-color);
                color: var(--primary-color);
                font-weight: 500;
                border-radius: 4px;
                transition: var(--transition);
            }
            
            .btn-warning:hover {
                background-color: #d4b15c;
                border-color: #d4b15c;
                color: var(--primary-color);
                transform: translateY(-2px);
            }
            
            .btn-danger {
                background-color: var(--danger-color);
                border-color: var(--danger-color);
                border-radius: 4px;
                transition: var(--transition);
            }
            
            .btn-danger:hover {
                background-color: #c82333;
                border-color: #c82333;
                transform: translateY(-2px);
            }
            
            .btn-success {
                background-color: var(--success-color);
                border-color: var(--success-color);
                border-radius: 4px;
                transition: var(--transition);
            }
            
            .btn-success:hover {
                background-color: #218838;
                border-color: #218838;
                transform: translateY(-2px);
            }
            
            .btn-secondary {
                background-color: #6c757d;
                border-color: #6c757d;
                border-radius: 4px;
                transition: var(--transition);
            }
            
            .btn-secondary:hover {
                background-color: #5a6268;
                border-color: #5a6268;
                transform: translateY(-2px);
            }
            
            /* Tablas */
            .table {
                border-collapse: separate;
                border-spacing: 0;
                width: 100%;
                border-radius: var(--border-radius);
                overflow: hidden;
            }
            
            .table thead th {
                background-color: var(--primary-color);
                color: var(--text-light);
                font-weight: 600;
                border: none;
                padding: 1rem;
            }
            
            .table tbody td {
                padding: 1rem;
                vertical-align: middle;
                border-bottom: 1px solid var(--border-color);
            }
            
            .table-striped tbody tr:nth-of-type(odd) {
                background-color: rgba(248, 249, 250, 0.5);
            }
            
            .table-hover tbody tr:hover {
                background-color: rgba(201, 169, 110, 0.1);
            }
            
            /* Formularios */
            .form-control {
                border: 1px solid var(--border-color);
                border-radius: 4px;
                padding: 0.75rem;
                font-size: 1rem;
                transition: var(--transition);
            }
            
            .form-control:focus {
                border-color: var(--secondary-color);
                box-shadow: 0 0 0 0.25rem rgba(201, 169, 110, 0.25);
            }
            
            .form-label {
                font-weight: 500;
                margin-bottom: 0.5rem;
                color: var(--primary-color);
            }
            
            /* Modal */
            .modal-content {
                border: none;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            }
            
            .modal-header {
                background-color: var(--primary-color);
                color: var(--text-light);
                border-bottom: 3px solid var(--secondary-color);
            }
            
            .modal-footer {
                border-top: 1px solid var(--border-color);
            }
            
            /* Sección de agregar */
            .bg-light {
                background-color: var(--light-bg) !important;
                border-radius: var(--border-radius);
                padding: 1.5rem !important;
                margin-bottom: 1.5rem;
            }
            
            /* Tarjeta de total */
            .card.bg-success {
                background: linear-gradient(135deg, var(--primary-color), #333) !important;
                border: none;
                border-radius: var(--border-radius);
                box-shadow: var(--box-shadow);
            }
            
            .card.bg-success .card-body {
                padding: 2rem 1.5rem;
            }
            
            .card.bg-success h3,
            .card.bg-success h4 {
                color: var(--text-light);
            }
            
            .card.bg-success i {
                font-size: 2.5rem;
                margin-bottom: 1rem;
                opacity: 0.9;
            }
            
            /* Animaciones */
            @keyframes slideUp {
                from {
                    transform: translateY(30px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }
            
            .animate-slide-up {
                animation: slideUp 0.3s ease-out;
            }
            
            /* Responsive */
            @media (max-width: 768px) {
                .btn-group {
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                }
                
                .btn-group .btn {
                    width: 100%;
                    margin: 0;
                }
                
                .table-responsive {
                    border-radius: var(--border-radius);
                    overflow: hidden;
                }
            }
            
            /* Iconos en tabla */
            .table i.fa-solid {
                margin-right: 0.5rem;
            }
            
            /* Texto de ayuda */
            .form-text {
                font-size: 0.875rem;
                color: #6c757d;
                margin-top: 0.25rem;
            }
            
            /* Header mejorado */
            .bg-info {
                background-color: var(--primary-color) !important;
            }
        </style>
        
        <script th:src="@{/js/rutinas_js}"></script>
        <script th:src="@{/webjars/jquery/jquery.min.js}"></script>
        <script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
        <script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
    </head>
    <body>
        <!-- fragmento 1 para Agregar cliente en ventana modal -->
        <section th:fragment="agregar">
            <!-- Button trigger modal -->
            <div class='container py-4'>
                <div class='row mb-4'>
                    <div class='col-12'>
                        <div class="d-flex justify-content-between align-items-center bg-light p-4 rounded">
                            <div>
                                <h3 class="mb-1">[[#{cliente.listado}]]</h3>
                                <p class="text-muted mb-0">Administra los clientes de Legado Barbería</p>
                            </div>
                            <button type="button" class="btn btn-primary"  sec:authorize="hasRole('ROLE_ADMIN')"
                                    data-bs-toggle="modal" data-bs-target="#agregarClienteModal">
                                <i class="fa-solid fa-plus me-2"></i> [[#{cliente.agregar}]]
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modal -->
            <div class="modal fade" id="agregarClienteModal"  tabindex="-1" 
                 aria-labelledby="agregarClienteModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="agregarClienteModalLabel">
                                <i class="fa-solid fa-user-plus me-2"></i> [[#{cliente.agregar}]]
                            </h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form th:action='@{/cliente/guardar}' th:object='${cliente}'
                              class='was-validated' method="post">
                            <div class="modal-body">
                                <div class='mb-3'>
                                    <label class="form-label">[[#{cliente.nombre}]]</label>
                                    <input type="text" name='nombre' class='form-control' required="true"
                                           placeholder="Nombre completo del cliente"/>
                                    <div class="form-text">Ingresa el nombre completo del cliente</div>
                                </div>
                                <div class='mb-3'>
                                    <label class="form-label">[[#{cliente.telefono}]]</label>
                                    <input type="text" name='telefono' class='form-control'
                                           placeholder="Número de teléfono"/>
                                    <div class="form-text">Ejemplo: (123) 456-7890</div>
                                </div>
                                <div class='mb-3'>
                                    <label class="form-label">[[#{cliente.email}]]</label>
                                    <input type="email" name='email' class='form-control'
                                           placeholder="correo@ejemplo.com"/>
                                    <div class="form-text">Dirección de correo electrónico del cliente</div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                                    <i class="fa-solid fa-xmark me-2"></i> [[#{accion.cerrar}]]
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fa-solid fa-floppy-disk me-2"></i> [[#{accion.guardar}]]
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- fragmento 2 para el listado de clientes -->
        <section th:fragment="listado" class="p-3">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-9">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fa-solid fa-users me-2"></i> [[#{cliente.listado}]]</h4>
                            </div>
                            <div class="card-body">
                                <div th:if="${clientes != null and !clientes.empty}">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>[[#{cliente.nombre}]]</th>
                                                    <th>[[#{cliente.telefono}]]</th>
                                                    <th>[[#{cliente.email}]]</th>
                                                    <th class="text-end" sec:authorize="hasRole('ROLE_ADMIN')">Acciones</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr th:each="c : ${clientes}">
                                                    <td class="fw-bold">[[${c.idCliente}]]</td>
                                                    <td>
                                                        <strong>[[${c.nombre}]]</strong>
                                                    </td>
                                                    <td>
                                                        <span th:if="${c.telefono}" class="text-muted">
                                                            <i class="fa-solid fa-phone me-2"></i>[[${c.telefono}]]
                                                        </span>
                                                        <span th:unless="${c.telefono}" class="text-muted">
                                                            <i class="fa-solid fa-phone-slash me-2"></i>No registrado
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span th:if="${c.email}" class="text-muted">
                                                            <i class="fa-solid fa-envelope me-2"></i>[[${c.email}]]
                                                        </span>
                                                        <span th:unless="${c.email}" class="text-muted">
                                                            <i class="fa-solid fa-envelope-open-text me-2"></i>No registrado
                                                        </span>
                                                    </td>
                                                    <td class="text-end" sec:authorize="hasRole('ROLE_ADMIN')">
                                                        <div class="btn-group btn-group-sm" role="group">
                                                            <a th:href="@{/cliente/modificar/}+${c.idCliente}" class="btn btn-outline-warning">
                                                                <i class="fas fa-pencil-alt me-1"></i> [[#{accion.actualizar}]]
                                                            </a>
                                                            <button type="button" class="btn btn-outline-danger"
                                                                    data-bs-toggle="modal" data-bs-target="#confirmModal"
                                                                    th:data-bs-id="${c.idCliente}"
                                                                    th:data-bs-nombre="${c.nombre}">
                                                                <i class="fa-solid fa-trash me-1"></i> [[#{accion.eliminar}]]
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="text-center p-5" th:if="${clientes == null or clientes.empty}">
                                    <div class="py-5">
                                        <i class="fa-solid fa-user-slash fa-3x text-muted mb-3"></i>
                                        <h5 class="text-muted mb-3">[[#{lista.vacia}]]</h5>
                                        <p class="text-muted">No hay clientes registrados todavía.</p>
                                        <button type="button" class="btn btn-primary mt-2" sec:authorize="hasRole('ROLE_ADMIN')"
                                                data-bs-toggle="modal" data-bs-target="#agregarClienteModal">
                                            <i class="fa-solid fa-plus me-2"></i> Agregar primer cliente
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                   
                </div>
            </div>
        </section>

        <!-- 3 Fragmento que se utiliza en la página modifica.html -->
        <section th:fragment="editar">
            <div class="container py-4">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h4 class="mb-0">
                                            <i class="fas fa-pencil-alt me-2"></i>
                                            [[#{accion.actualizar}]] Cliente
                                        </h4>
                                        <p class="mb-0 text-light opacity-75">Modifica los datos del cliente</p>
                                    </div>
                                    <a th:href="@{/cliente/listado}" class="btn btn-outline-light">
                                        <i class="fas fa-arrow-left me-2"></i> Volver al listado
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <form method="POST" th:action="@{/cliente/guardar}" 
                              th:object="${cliente}" class="was-validated">
                            <input type="hidden" name="idCliente" th:field="*{idCliente}"/>
                            
                            <div class="card">
                                <div class="card-body">
                                    <div class="mb-4">
                                        <h5 class="mb-3">Información del Cliente</h5>
                                        <div class="mb-3">
                                            <label for="nombre" class="form-label">[[#{cliente.nombre}]]</label>
                                            <input type="text" class="form-control" name="nombre" 
                                                   th:field="*{nombre}" required="true"
                                                   placeholder="Nombre completo del cliente"/>
                                            <div class="form-text">Ingresa el nombre completo del cliente</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="telefono" class="form-label">[[#{cliente.telefono}]]</label>
                                            <input class="form-control" type="text" 
                                                   name="telefono" id="telefono" th:field="*{telefono}"
                                                   placeholder="Número de teléfono"/>
                                            <div class="form-text">Ejemplo: (123) 456-7890</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="email" class="form-label">[[#{cliente.email}]]</label>
                                            <input class="form-control" type="email" name="email"
                                                   th:field="*{email}"
                                                   placeholder="correo@ejemplo.com"/>
                                            <div class="form-text">Dirección de correo electrónico válida</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer bg-light">
                                    <div class="d-flex justify-content-between">
                                        <a th:href="@{/cliente/listado}" class="btn btn-secondary">
                                            <i class="fas fa-arrow-left me-2"></i> [[#{accion.regresar}]]
                                        </a>
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-check me-2"></i> [[#{accion.guardar}]]
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4 fragmento que se utiliza para confirmar que se desea eliminar un cliente -->
        <section th:fragment="confirmarEliminar">
            <div class="modal fade" 
                 id="confirmModal" 
                 tabindex="-1" 
                 aria-labelledby="modalLabel" 
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content animate-slide-up">
                        <form th:action="@{/cliente/eliminar}" th:object="${cliente}" method="post">
                            <input type="hidden" name="idCliente" id="modalId"/>
                            <div class="modal-header bg-warning">
                                <h5 class="modal-title" id="modalLabel">
                                    <i class="fa-solid fa-triangle-exclamation me-2"></i> [[#{accion.confirmar}]]
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                            </div>
                            <div class="modal-body text-center py-4">
                                <div class="mb-4">
                                    <i class="fa-solid fa-user-xmark fa-3x text-warning mb-3"></i>
                                    <h5 class="fw-bold">¿Confirmar eliminación?</h5>
                                </div>
                                <p class="mb-3">[[#{accion.confirmar.texto1}]] <span id="modalNombre" class="fw-bold text-danger"></span>?</p>
                                <div class="alert alert-warning" role="alert">
                                    <i class="fa-solid fa-circle-exclamation me-2"></i>
                                    [[#{accion.confirmar.texto2}]]
                                </div>
                            </div>
                            <div class="modal-footer justify-content-center">
                                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                                    <i class="fa-solid fa-xmark me-2"></i> [[#{accion.cerrar}]]
                                </button>
                                <button type="submit" class="btn btn-danger">
                                    <i class="fa-solid fa-trash me-2"></i> [[#{accion.eliminar}]]
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Footer -->
        <footer th:fragment="footer" class="p-4 mt-5" style="background: linear-gradient(135deg, var(--primary-color) 0%, #333 100%);">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 text-center">
                        <p class="lead mb-0 text-white">[[#{plantilla.derechos}]] &copy; <span th:text="${#dates.year(#dates.createNow())}">2024</span></p>
                        <p class="small mt-2 text-white opacity-75">Legado Barbería - Sistema de gestión de clientes</p>
                    </div>
                </div>
            </div>
        </footer>
        
        <!-- Scripts -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Configurar modal de confirmación de eliminación
                const confirmModal = document.getElementById('confirmModal');
                if (confirmModal) {
                    confirmModal.addEventListener('show.bs.modal', function(event) {
                        const button = event.relatedTarget;
                        const id = button.getAttribute('data-bs-id');
                        const nombre = button.getAttribute('data-bs-nombre');
                        
                        document.getElementById('modalId').value = id;
                        document.getElementById('modalNombre').textContent = nombre;
                    });
                }
            });
        </script>
      
    </body>
</html>